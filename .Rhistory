fundCode <- c(tbl.Cancels[,9], tbl.scholarshipAwd[,4], tbl.scholarshipCohorts[,4], tbl.GaCommitmentFundList.OSFA[,3])
fundCode
fundCode <- stack(fundCode)                                                                                     #stack columns on top of each other
fundCode <- fundCode[,1]
fundCode <- c(tbl.Cancels[,9], tbl.scholarshipAwd[,4], tbl.scholarshipCohorts[,4], tbl.GaCommitmentFundList.OSFA[,3])   #concatenate fundCode columns
fundCode <- stack(fundCode)                                                                                     #stack columns on top of each other
fundCode <- fundCode[,1]
fundCode
fundCode <- c(tbl.Cancels[,9], tbl.scholarshipAwd[,4], tbl.scholarshipCohorts[,4], tbl.GaCommitmentFundList.OSFA[,3])   #concatenate fundCode columns
fundCode <- stack(fundCode)
fundCode <- c(tbl.Cancels[,9], tbl.scholarshipAwd[,4], tbl.scholarshipCohorts[,4], tbl.GaCommitmentFundList.OSFA[,3])
View(fundCode)
fundCode <- stack(fundCode)
View(fundCode)
fundCode <- fundCode[,1]
fundCode <- c(tbl.Cancels[,9], tbl.scholarshipAwd[,4], tbl.scholarshipCohorts[,4], tbl.GaCommitmentFundList.OSFA[,3])   #concatenate fundCode columns
fundCode <- stack(fundCode)
View(fundCode)
fundCode <- as.data.table(fundCode)
View(fundCode)
fundCode <- fundCode[,1]
fundCode <- c(tbl.Cancels[,9], tbl.scholarshipAwd[,4], tbl.scholarshipCohorts[,4], tbl.GaCommitmentFundList.OSFA[,3])
View(fundCode)
fundCode <- stack(fundCode)                                                                                     #stack
View(fundCode)
View(fundCode)
fundCode <- c(tbl.Cancels[,9], tbl.scholarshipAwd[,4], tbl.scholarshipCohorts[,4], tbl.GaCommitmentFundList.OSFA[,3])
View(fundCode)
View(osfaCode)
osfaCode <- c(tbl.BannerCohorts[,5], tbl.scholarshipAwd[,3], tbl.scholarshipCohorts[,3])
View(osfaCode)
osfaCode <- stack(osfaCode)
View(osfaCode)
View(osfaCode)
osfaCode <- c(tbl.BannerCohorts[,5], tbl.scholarshipAwd[,3], tbl.scholarshipCohorts[,3])
View(osfaCode)
t(osfaCode)
t(osfaCode)
View(osfaCode)
t(as.data.frame.table(osfaCode))
as.data.frame.table(t(osfaCode))
melt(osfaCode)
osfaCode <- c(tbl.BannerCohorts[,5], tbl.scholarshipAwd[,3], tbl.scholarshipCohorts[,3])
View(osfaCode)
melt.list(osfaCode)
View(osfaCode)
View(osfaCode)
osfaCode<-melt.list(osfaCode)
View(osfaCode)
osfaCode<-melt.list(osfaCode)
osfaCode <- osfaCode[,1]
osfaCode <- as.data.table(osfaCode[,1] )
osfaCode <- c(tbl.BannerCohorts[,5], tbl.scholarshipAwd[,3], tbl.scholarshipCohorts[,3])
osfaCode <- melt(osfaCode)                                                                                     #stack columns on top of each other
osfaCode <- osfaCode[,1]                                                                                        #extract the first column only
names(osfaCode) <- c("osfaCode")                                                                                #rename columns
osfaCode <- as.data.table(osfaCode)                                                                             #convert to a data.table
View(osfaCode)
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
View(fundCode)
View(jctCode)
View(studentID)
studentID <- complete.cases(studentID)
studentID <- as.data.table(studentID)
View(studentID)
studentID <- c(tbl.BannerCohorts[,2], tbl.Cancels[,5], tbl.scholarshipAwd[,5], tbl.scholarshipCohorts[,11])     #concatenate studentID columns
studentID <- melt(studentID)                                                                                   #stack columns on top of each other
studentID <- studentID[,1]                                                                                      #extract the first column only
studentID <- as.data.table(studentID)                                                                           #convert to a data.table
studentID <- subset(studentID, studentID!=0)                                                                    #remove rows containing zero
studentID = studentID%>%na.omit()
View(studentID)
studentID <- studentID%>%na.omit()
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
View(studentID)
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
View(studentID)
studentID<-filter(studentID, !is.na(studentID))
studentID<-filter(studentID, studentID !=="")
studentID <- studentID[!apply(is.na(studentID) | studentID == "", 1, all),]
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
View(studentID)
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
View(studentID)
studentID <- studentID[!apply(is.na(studentID) | studentID == "", 1, all),]
studentID <- studentID[!apply(is.na(studentID) | studentID == "", 1, all),]
studentID[!apply(studentID == "", 1, all),]
studentID<-studentID[!apply(studentID == "", 1, all),]
studentID[!is.na(studentID$studentID),]
studentID<-studentID[!is.na(studentID$studentID),]
studentID <- studentID %>% na.omit()
View(studentID)
studentID <- studentID[!apply(is.na(studentID) | studentID == "", 1, all),]
studentID <- studentID[!apply(is.na(studentID) | studentID == "", 2, all),]
studentID <- studentID[!apply(is.na(studentID) | studentID == "", 1, all),]
studentID <- subset(studentID, studentID!="")
studentID <- subset(studentID, studentID!=0 | studentID!="")
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
View(studentID)
studentID <- subset(studentID, studentID!=0 | studentID!="")
studentID <- subset(studentID, studentID!=0 & studentID!="")
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
View(studentID)
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
tbl.studentBalance<-tbl.BannerCohorts %>%
group_by(osfaCode) %>%
select(osfaCode, AY_1718, AY_1819, AY_1920, AY_2021, AY_2122, AY_2223, AY_2324, AY_2425 ) %>%
summarize(totBalStudent=sum(AY_1718, AY_1819, AY_1920, AY_2021, AY_2122, AY_2223, AY_2324, AY_2425)) %>%
arrange(osfaCode)
# Example preprocessing script.
require(stats)
data_files <- file.info(Sys.glob("y:/Reports/Banner/Argos/Test/*.csv"))
row.names(data_files)[which.max(data_files[["ctime"]])]                                                         #find the most recent version
#import .csv file
tbl.scholar<-read.csv(row.names(data_files)[which.max(data_files[["ctime"]])], header=TRUE, sep=",", colClasses=c("Date", rep("character",2),"numeric","character", rep("numeric",8)))
#tbl.scholar$spriden_id  <- as.character(tbl.scholar$spriden_id)                                                #convert spriden to character
names(tbl.scholar)[2] <- "studentID"                                                                            #rename to studentID
names(tbl.scholar)[5] <- "fundCode"                                                                             #rename to studentID
#tbl.scholar$SYSDATE <- as.Date(as.character(tbl.scholar$SYSDATE), "%m/%d/%Y")                                  #convert SYSDATE to date only
tbl.scholar[ is.na(tbl.scholar) ] <- 0                                                                          #replace na's with 0
# dup.DF(tbl.scholar, "cohort")
colNames <- c("ay_2223", "ay_2324")
#colNames <- list("ay_2223", "ay_2324")
#colNames <- paste0("ay_", c(ay$V1))
# z<-head(paste0("ay_", c(ay$V1)),4)
a<-as.character(rep(head(ay$V1,1),4))
b<-head(paste0("ay_", ay$V2),4)
tbl.scholar1 <- tbl.scholar
tbl.scholar1<-tbl.scholar1%>%mutate_cond(cohort == currentAY, ay_1819=ay_1718, ay_1920=ay_1718, ay_2021=ay_1718)
tbl.scholar1<-tbl.scholar1%>%mutate_cond(cohort == currentAY+101, ay_1920=ay_1819, ay_2021=ay_1819, ay_2122=ay_1819)
#tbl.scholar1<-dup.DF(tbl.scholar1, currentAY, 4, "ay_1718", "ay_2324")
#tbl.scholar1<-dup.DF(tbl.scholar1, currentAY, 4, "ay_1718", "ay_2324")
#tbl.scholar1<-dup.DF(tbl.scholar1, currentAY, 4, "ay_1718", colNames)                              #20180606b
#Dynamic Approach to propagate scholarship amount to the ensuing three years ####
st_pos <- 6                                                                                         #concerned column's start position in the given dataframe
df <- tbl.scholar                                                                                   #data backup
#rename concerned columns as "ay_1718", "ay_1819" etc
names(df)[st_pos:ncol(df)] <- paste("ay", paste0(as.numeric(substr(min(df$cohort), 1, 2)) + 0:(ncol(df) - st_pos),
as.numeric(substr(min(df$cohort), 3, 4)) + 0:(ncol(df) - st_pos)),
sep="_")
#copy "year" column's value to the ensuing three columns
cols <- names(df)[st_pos:ncol(df)]                                                                  #renamed columns
mapply(function(x, y)
df[df$cohort == x & df$studentID == y, which(grepl(x, cols)) + (st_pos-1):(st_pos+2)] <<-
df[df$cohort == x & df$studentID == y, which(grepl(x, cols)) + (st_pos-1)],
df$cohort, df$studentID)
#End of Dynamic Approach ####
#funcCode
fundCode <- c(tbl.Cancels[,9], tbl.scholarshipAwd[,4], tbl.scholarshipCohorts[,4], tbl.GaCommitmentFundList.OSFA[,3])   #concatenate fundCode columns
fundCode <- melt(fundCode)                                                                                     #stack columns on top of each other
fundCode <- fundCode[,1]                                                                                        #extract the first column only
fundCode <- as.data.table(fundCode)                                                                             #convert to a data.table
fundCode <- subset(fundCode, fundCode!=0)                                                                       #remove rows containing zero
fundCode <- unique(fundCode)                                                                                    #extract the unique values
fundCode <- setorder(fundCode, fundCode)                                                                        #sort the fundCode column
fundCode <- fundCode %>% left_join(select(tbl.GaCommitmentFundList.OSFA, fundCode, fundName), by.x = "fundCode")
fundCode$fundName[is.na(fundCode$fundName)] <- ""                                                               #replace na's with blanks in fund name
#jctCode
jctCode <- c(tbl.scholarshipCohorts[,4], tbl.scholarshipCohorts[,3])                                            #concatenate jctCode columns
names(jctCode) <- c("fundCode", "osfaCode")                                                                     #rename columns
jctCode <- as.data.table(jctCode)                                                                               #convert to a data.table
jctCode <- subset(jctCode, fundCode!=0 & osfaCode !=0)                                                          #remove rows containing zero
jctCode <- unique(jctCode)                                                                                      #extract the unique values
jctCode <- setorder(jctCode, fundCode)                                                                          #sort the fundCode column
jctCode<-jctCode %>% left_join(select(fundCode, fundCode, fundName), by.x = "fundCode")                         #add the fundName column
#jctCohortCode
jctCohortCode <- c(tbl.BannerCohorts[,2], tbl.BannerCohorts[,5])                                                #concatenate Banner Cohort columns
names(jctCohortCode) <- c("studentID", "fundCode")                                                              #rename columns
jctCohortCode <- as.data.table(jctCohortCode)                                                                   #convert to a data.table
jctCohortCode <- subset(jctCohortCode, fundCode!=0 & studentID !=0)                                             #remove rows containing zero
jctCohortCode <- unique(jctCohortCode)                                                                          #extract the unique values
jctCohortCode <- setorder(jctCohortCode, studentID)                                                             #sort the studentID column
#osfaCode
osfaCode <- c(tbl.BannerCohorts[,5], tbl.scholarshipAwd[,3], tbl.scholarshipCohorts[,3])                        #concatenate fundCode columns
osfaCode <- melt(osfaCode)                                                                                     #stack columns on top of each other
osfaCode <- osfaCode[,1]                                                                                        #extract the first column only
names(osfaCode) <- c("osfaCode")                                                                                #rename columns
osfaCode <- as.data.table(osfaCode)                                                                             #convert to a data.table
osfaCode <- subset(osfaCode, osfaCode!=0)                                                                       #remove rows containing zero
osfaCode <- unique(osfaCode)                                                                                    #extract the unique values
osfaCode <- setorder(osfaCode, osfaCode)                                                                        #sort the osfaCode column
#studentID
studentID <- c(tbl.BannerCohorts[,2], tbl.Cancels[,5], tbl.scholarshipAwd[,5], tbl.scholarshipCohorts[,11])     #concatenate studentID columns
studentID <- melt(studentID)                                                                                   #stack columns on top of each other
studentID <- studentID[,1]                                                                                      #extract the first column only
studentID <- as.data.table(studentID)                                                                           #convert to a data.table
studentID <- subset(studentID, studentID!=0 & studentID!="")                                                                    #remove rows containing zero
studentID <- unique(studentID)                                                                                  #extract the unique values
#studentID <- studentID[!apply(is.na(studentID) | studentID == "", 1, all),]                                             #remove rows containing blanks & na's
studentID <- setorder(studentID, studentID)                                                                     #sort the studentID column
#Join three Tables - use `nomatch` argument-> i.e., nomatch-0
tbl.CohortAwd<-tbl.BannerCohorts[tbl.scholarshipAwd,nomatch=0,on=c("studentID", "osfaCode")][tbl.scholarshipCohorts,nomatch=0,on=c("studentID", "osfaCode")]
# tbl.CohortAwd<-tbl.BannerCohorts[tbl.scholarshipAwd, nomatch=0, on=c("studentID", "osfaCode")]                #Join Banner Cohorts + scholarshipAwd tables
tbl.CohortAwd <- tbl.CohortAwd %>%
mutate_all(funs(replace(., is.na(.), 0)))                                                                   #20180516b
as.numeric(as.character(tbl.CohortAwd$Award))                                                                   #covert CohortAwd$Award from character to numeric
tbl.CohortAwdByFY <- data.table(tbl.CohortAwd)[,.(FY, Award)]
tbl.CohortAwdByFY[,meanAwdByFY:=mean(Award), by=FY]
x<-tbl.CohortAwd %>% select(FY, Award) %>%
group_by(FY) %>%
dplyr::summarize(AvgAward = mean(Award),
MedianAward = as.numeric(median(Award)),
total = n()) %>%
arrange(FY)
tbl.GaCommit <- tbl.CohortAwd %>%
select(FY, osfaCode, fundCode, AccountName, Requirement, Active, Award, MajorChanges, ReplacementScholar, studentID, NAME, AY_1718, AY_1819, AY_1920, AY_2021, AY_2122, AY_2223, AY_2324,AY_2425, OSFA.Notes, Rural, FundAgreement, message, eMail, Special.Circumstances, SCR.Complete ) %>%
group_by(FY, osfaCode, studentID) %>%
mutate_all(funs(replace(., is.na(.), 0)))
tbl.fundBalance<-tbl.GaCommitmentFundList.OSFA %>%
group_by(fundCode, fundName) %>%
select(fundCode, fundName, incomeBalance, principleBalance, invested.Balance) %>%
summarize(incBal=sum(incomeBalance), principleBal=sum(principleBalance), invBal=sum(invested.Balance)) %>%
mutate(totBalFund = incBal+principleBal+invBal) %>%
arrange(fundCode, fundName)
#tbl.fundBalance<-inner_join(tbl.fundBalance, jctCode)
tbl.BannerCohorts[ is.na(tbl.BannerCohorts) ] <- 0
tbl.BannerCohorts %>%
mutate_at(vars(AY_1718, AY_1819, AY_1920, AY_2021, AY_2122, AY_2223, AY_2324, AY_2425), as.numeric)
tbl.studentBalance<-tbl.BannerCohorts %>%
group_by(osfaCode) %>%
select(osfaCode, AY_1718, AY_1819, AY_1920, AY_2021, AY_2122, AY_2223, AY_2324, AY_2425 ) %>%
summarize(totBalStudent=sum(AY_1718, AY_1819, AY_1920, AY_2021, AY_2122, AY_2223, AY_2324, AY_2425)) %>%
arrange(osfaCode)
tbl.fundSummary<-select(select(inner_join(tbl.fundBalance,jctCode, by='fundCode')%>%inner_join(., tbl.studentBalance, by='osfaCode'), -ends_with(".y")),osfaCode, fundCode:totBalFund, totBalStudent)%>%mutate(totBalRemain = totBalFund - totBalStudent)
#write output .csv files
write.csv(jctCode, "output/jct_Code.csv", row.names=F)
write.csv(fundCode, "output/tbl_fundCode.csv", row.names=F)
write.csv(jctCohortCode, "output/jct_CohortCode.csv", row.names=F)
write.csv(osfaCode, "output/tbl_osfaCode.csv", row.names=F)
write.csv(studentID, "output/tbl_studentId.csv", row.names=F)
#write.csv(tbl.balance, "output/tbl_balance.csv", row.names=F)
write.csv(tbl.CohortAwd, "output/tbl_CohortAwd.csv", row.names=F)
write.csv(tbl.fundBalance, "output/tbl_fundBalance.csv", row.names=F)
write.csv(tbl.GaCommit, "output/tbl_GaCommit.csv", row.names=F)
write.csv(tbl.scholar, "output/tbl_scholar.csv", row.names=F)
write.csv(tbl.studentBalance, "output/tbl_studentBalance.csv", row.names=F)
#write output .xlsx files
# write.xlsx(fundCode, "output/tbl_fundCode.xlsx", row.names=F, sheetName="tblFundCode", append=FALSE)
# write.xlsx(jctCode, "output/tbl_jctCode.xlsx", row.names=F, sheetName="tbl_jctCode")
# write.xlsx(jctCohortCode, "output/tbl_jctCohortCode.xlsx", row.names=F, sheetName="tbl_jctCohortCode")
# write.xlsx(osfaCode, "output/tbl_osfaCode.xlsx", row.names=F, sheetName="tbl_osfaCode")
# write.xlsx(studentID, "output/tbl_studentID.xlsx", row.names=F, sheetName="tbl_studentID")
# write.xlsx(as.data.frame(tbl.balance), "output/tbl_balance.xlsx", row.names=F, sheetName="tbl_balance")
# write.xlsx(as.data.frame(tbl.BannerCohorts), "output/tbl_bannerCohorts.xlsx", row.names=F, sheetName="tbl_bannerCohorts")
# write.xlsx(as.data.frame(tbl.CohortAwd), "output/tbl_cohortAwd.xlsx", row.names=F, sheetName="tbl_cohortAwd")
# write.xlsx(as.data.frame(tbl.fundBalance), "output/tbl_fundBalance.xlsx", row.names=F, sheetName="tbl_fundBalance")
# write.xlsx(as.data.frame(tbl.GaCommit), "output/tbl_GaCommit.xlsx", row.names=F, sheetName="tbl_GaCommit")
# write.xlsx(as.data.frame(tbl.GaCommitmentFundList.OSFA), "output/tbl_GaCommitFundList.xlsx", row.names=F, sheetName="tbl_GaCommitFundList")
# write.xlsx(tbl.scholar, "output/tbl_scholar.xlsx", row.names=F, sheetName="tbl_scholar")
# write.xlsx(as.data.frame(tbl.studentBalance), "output/tbl_studentBalance.xlsx", row.names=F, sheetName="tbl_studentBalance")
write.xlsx(jctCode, "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_jctCode", append=FALSE)
write.xlsx(fundCode, "output/tbl_scholarships.xlsx", row.names=F, sheetName="tblFundCode", append=TRUE)
write.xlsx(jctCohortCode, "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_jctCohortCode", append=TRUE)
write.xlsx(osfaCode, "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_osfaCode", append=TRUE)
write.xlsx(studentID, "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_studentID", append=TRUE)
write.xlsx(tbl.scholar, "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_scholar", append=TRUE)
#write.xlsx(as.data.frame(tbl.balance), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_balance", append=TRUE)
write.xlsx(as.data.frame(tbl.BannerCohorts), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_bannerCohorts", append=TRUE)
write.xlsx(as.data.frame(tbl.CohortAwd), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_cohortAwd", append=TRUE)
write.xlsx(as.data.frame(tbl.fundBalance), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_fundBalance", append=TRUE)
write.xlsx(as.data.frame(tbl.GaCommit), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_GaCommit", append=TRUE)
write.xlsx(as.data.frame(tbl.GaCommitmentFundList.OSFA), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_GaCommitFundList", append=TRUE)
write.xlsx(as.data.frame(tbl.studentBalance), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_studentBalance", append=TRUE)
write.xlsx(as.data.frame(tbl.fundSummary), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl.fundSummary", append=TRUE)
write.xlsx(tbl.scholar, "output/tbl_scholar.xlsx", row.names=F, sheetName="tbl_scholar", append=FALSE)
write.xlsx(tbl.scholar1, "output/tbl_scholar1.xlsx", row.names=F, sheetName="tbl_scholar1", append=FALSE)
write.xlsx(df, "output/tbl_scholar2.xlsx", row.names=F, sheetName="tbl_scholar2", append=FALSE)
#write output .csv files
write.csv(jctCode, "output/jct_Code.csv", row.names=F)
write.csv(fundCode, "output/tbl_fundCode.csv", row.names=F)
write.csv(jctCohortCode, "output/jct_CohortCode.csv", row.names=F)
write.csv(osfaCode, "output/tbl_osfaCode.csv", row.names=F)
write.csv(studentID, "output/tbl_studentId.csv", row.names=F)
#write.csv(tbl.balance, "output/tbl_balance.csv", row.names=F)
write.csv(tbl.CohortAwd, "output/tbl_CohortAwd.csv", row.names=F)
write.csv(tbl.fundBalance, "output/tbl_fundBalance.csv", row.names=F)
write.csv(tbl.GaCommit, "output/tbl_GaCommit.csv", row.names=F)
write.csv(tbl.scholar, "output/tbl_scholar.csv", row.names=F)
write.csv(tbl.studentBalance, "output/tbl_studentBalance.csv", row.names=F)
#write output .xlsx files
# write.xlsx(fundCode, "output/tbl_fundCode.xlsx", row.names=F, sheetName="tblFundCode", append=FALSE)
# write.xlsx(jctCode, "output/tbl_jctCode.xlsx", row.names=F, sheetName="tbl_jctCode")
# write.xlsx(jctCohortCode, "output/tbl_jctCohortCode.xlsx", row.names=F, sheetName="tbl_jctCohortCode")
# write.xlsx(osfaCode, "output/tbl_osfaCode.xlsx", row.names=F, sheetName="tbl_osfaCode")
# write.xlsx(studentID, "output/tbl_studentID.xlsx", row.names=F, sheetName="tbl_studentID")
# write.xlsx(as.data.frame(tbl.balance), "output/tbl_balance.xlsx", row.names=F, sheetName="tbl_balance")
# write.xlsx(as.data.frame(tbl.BannerCohorts), "output/tbl_bannerCohorts.xlsx", row.names=F, sheetName="tbl_bannerCohorts")
# write.xlsx(as.data.frame(tbl.CohortAwd), "output/tbl_cohortAwd.xlsx", row.names=F, sheetName="tbl_cohortAwd")
# write.xlsx(as.data.frame(tbl.fundBalance), "output/tbl_fundBalance.xlsx", row.names=F, sheetName="tbl_fundBalance")
# write.xlsx(as.data.frame(tbl.GaCommit), "output/tbl_GaCommit.xlsx", row.names=F, sheetName="tbl_GaCommit")
# write.xlsx(as.data.frame(tbl.GaCommitmentFundList.OSFA), "output/tbl_GaCommitFundList.xlsx", row.names=F, sheetName="tbl_GaCommitFundList")
# write.xlsx(tbl.scholar, "output/tbl_scholar.xlsx", row.names=F, sheetName="tbl_scholar")
# write.xlsx(as.data.frame(tbl.studentBalance), "output/tbl_studentBalance.xlsx", row.names=F, sheetName="tbl_studentBalance")
write.xlsx(jctCode, "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_jctCode", append=FALSE)
write.xlsx(fundCode, "output/tbl_scholarships.xlsx", row.names=F, sheetName="tblFundCode", append=TRUE)
write.xlsx(jctCohortCode, "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_jctCohortCode", append=TRUE)
write.xlsx(osfaCode, "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_osfaCode", append=TRUE)
write.xlsx(studentID, "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_studentID", append=TRUE)
write.xlsx(tbl.scholar, "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_scholar", append=TRUE)
#write.xlsx(as.data.frame(tbl.balance), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_balance", append=TRUE)
write.xlsx(as.data.frame(tbl.BannerCohorts), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_bannerCohorts", append=TRUE)
write.xlsx(as.data.frame(tbl.CohortAwd), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_cohortAwd", append=TRUE)
write.xlsx(as.data.frame(tbl.fundBalance), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_fundBalance", append=TRUE)
write.xlsx(as.data.frame(tbl.GaCommit), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_GaCommit", append=TRUE)
write.xlsx(as.data.frame(tbl.GaCommitmentFundList.OSFA), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_GaCommitFundList", append=TRUE)
write.xlsx(as.data.frame(tbl.studentBalance), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl_studentBalance", append=TRUE)
write.xlsx(as.data.frame(tbl.fundSummary), "output/tbl_scholarships.xlsx", row.names=F, sheetName="tbl.fundSummary", append=TRUE)
write.xlsx(tbl.scholar, "output/tbl_scholar.xlsx", row.names=F, sheetName="tbl_scholar", append=FALSE)
write.xlsx(tbl.scholar1, "output/tbl_scholar1.xlsx", row.names=F, sheetName="tbl_scholar1", append=FALSE)
write.xlsx(df, "output/tbl_scholar2.xlsx", row.names=F, sheetName="tbl_scholar2", append=FALSE)
tbl.scholar<-read.csv(row.names(data_files)[which.max(data_files[["ctime"]])], header=TRUE, sep=",", colClasses=c("Date", rep("character",2),"numeric","character", rep("numeric",8)))
tbl.scholar<-read.csv(row.names(data_files)[which.max(data_files[["ctime"]])], header=TRUE, sep=",", colClasses=c("Date", rep("character",2),"numeric","character", rep("numeric",8)))
tbl.scholar<-read.csv(row.names(data_files)[which.max(data_files[["ctime"]])], header=TRUE, sep=",", colClasses=c("Date", rep("character",2),"numeric","character", rep("numeric",8)))
data_files <- file.info(Sys.glob("y:/Reports/Banner/Argos/Test/*.csv"))
row.names(data_files)[which.max(data_files[["ctime"]])]
tbl.scholar<-read.csv(row.names(data_files)[which.max(data_files[["ctime"]])], header=TRUE, sep=",", colClasses=c("Date", rep("character",2),"numeric","character", rep("numeric",8)))
View(data_files)
data_files <- file.info(Sys.glob("y:/Reports/Banner/Argos/Test/*.csv"))
row.names(data_files)[which.max(data_files[["ctime"]])]
data_files <- file.info(Sys.glob("y:/Reports/Banner/Argos/Test/*.csv"))
data_files <- file.info(Sys.glob("y:/Reports*.xml"))
data_files <- file.info(Sys.glob("y:/Reports/*.xml"))
data_files <- file.info(Sys.glob("c:/users/gfalk/documents/*.png"))
View(data_files)
data_files <- file.info(Sys.glob("y:/*.png"))
View(data_files)
data_files <- file.info(Sys.glob("y:/Reports/*.png"))
data_files <- file.info(Sys.glob("y:/Reports/Banner/*.png"))
data_files <- file.info(Sys.glob("y:/Reports/Banner/Argos/*.png"))
data_files <- file.info(Sys.glob("y:/Reports/Banner/Argos/Test/*.png"))
data_files <- file.info(Sys.glob("y:/Reports/Banner/Argos/Test/*.csv"))
data_files <- file.info(Sys.glob("y:/Reports/Banner/Argos/Test/*.csv"))
data_files <- file.info(Sys.glob("y:/Reports/Banner/Argos/Test/*.csv"))
View(data_files)
View(tbl.fundSummary)
tbl.fundSummary<-unique.data.frame(tbl.fundSummary)
View(tbl.fundSummary)
tbl.fundSummary<-unique.data.frame(select(select(inner_join(tbl.fundBalance,jctCode, by='fundCode')%>%inner_join(., tbl.studentBalance, by='osfaCode'), -ends_with(".y")),osfaCode, fundCode:totBalFund, totBalStudent)%>%mutate(totBalRemain = totBalFund - totBalStudent))
tbl.fundSummary<-as.data.table(unique.data.frame(select(select(inner_join(tbl.fundBalance,jctCode, by='fundCode')%>%inner_join(., tbl.studentBalance, by='osfaCode'), -ends_with(".y")),osfaCode, fundCode:totBalFund, totBalStudent)%>%mutate(totBalRemain = totBalFund - totBalStudent)))
is.data.table(tbl.fundSummary)
View(tbl.GaCommit)
ggplot2(tbl.fundSummary, aes(x=fundCode, y=totBalRemaining))
ggplot2(tbl.fundSummary, aes(x=fundCode, y=totBalRemaining))
ggplot2::aes(fundCode,totBalRemain)
ggplot(tbl.fundSummary, aes(fundCode, totBalRemain))+geom_point()
ggplot(tbl.fundSummary, aes(fundCode, totBalRemain))+geom_point()+ geom_smooth(method="lm")
g<-ggplot(tbl.fundSummary, aes(fundCode, totBalRemain))+geom_point()+ geom_smooth(method="lm")
plot(g)
g<-ggplot(tbl.fundSummary, aes(fundCode, totBalRemain))+geom_point() + geom_smooth(method="lm")
plot(g)
View(tbl.fundSummary)
View(tbl.fundBalance)
View(tbl.GaCommit)
is.data.table(tbl.GaCommit)
as.data.table(tbl.GaCommit)
is.data.table(tbl.GaCommit)
as.data.table(tbl.GaCommit)
is.data.table(tbl.GaCommit)
tbl.fundSummary
View(tbl.fundSummary)
setkey(tbl.GaCommit, FY)
tbl.GaCommit<-data.table(tbl.GaCommit)
is.data.table(tbl.GaCommit)
tables()
tbl.GaCommit[,sum(Award), by=FY]
setkey(tbl.GaCommit, FY)
tbl.GaCommit[,sum(Award), by=FY]
View(tbl.fundSummary)
setkey(tbl.GaCommit, osfaCode)
setkey(tbl.fundSummary, osfaCode)
tbl.fundByYear<- inner_join(tbl.fundSummary, tbl.GaCommit, by = "osfaCode")
View(tbl.fundByYear)
tbl.GaCommit %>% group_by(FY, osfaCode) %>% summarise(Award)
tbl.GaCommit %>% group_by(FY, osfaCode) %>% summarise(Award)
tbl.GaCommit %>% group_by(FY, osfaCode)
tbl.GaCommit %>% group_by(FY, osfaCode) %>% select(FY, osfaCode, AccountName, Award)
tbl.GaCommit %>% group_by(FY, osfaCode) %>% select(FY, osfaCode, AccountName, Award) %>% summarize(Award)
tbl.GaCommit %>% group_by(FY, osfaCode) %>% select(FY, osfaCode, AccountName, Award) %>% summarize(sum(Award))
tbl.GaCommit %>% group_by(FY, osfaCode, AccountName) %>% select(FY, osfaCode, AccountName, Award) %>% summarize(sum(Award))
tbl.GaCommit[,lapply(.SD, sum), by=list(FY, osfaCode, AccountName)]
tbl.GaCommit[,lapply(sum), by=list(FY, osfaCode, AccountName)]
tbl.GaCommit[,lapply(.SD, sum), by=list(FY, osfaCode, AccountName)]
tbl.GaCommit[,lapply(.SD, sum), by=(FY, osfaCode, AccountName)]
tbl.GaCommit[,lapply(sum), by=list(FY, osfaCode, AccountName)]
tbl.GaCommit[,lapply(.SD, sum), by=(FY, osfaCode, AccountName)]
tbl.GaCommit[,lapply(.SD, sum), by=(FY, osfaCode, AccountName)]
tbl.GaCommit[,lapply(.SD, sum), by=list(FY, osfaCode, AccountName)]
tbl.GaCommit[,sum(Award), by=list(FY, osfaCode, AccountName)]
data_files <- file.info(Sys.glob("y:/Reports/Banner/Argos/Test/*.csv"))
View(config)
data_files <- file.info(Sys.glob("y:/Reports/Banner/Argos/Test/*.csv"))
data_files <- file.info(Sys.glob("y:/Reports/Banner/Argos/Test/*.csv"))
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
View(chart.GaCommitByFund01)
View(chart.GaCommitByYear)
View(chart.GaCommitByFund01)
View(chart.GaCommitByFund02)
View(tbl.GaCommitmentFundList.OSFA)
tbl.GaCommitmentFundList.OSFA[,sum(totalCommitment), by=list(fundraisingUnit)]
chart.GaCommitByUnit<-tbl.GaCommitmentFundList.OSFA[,sum(totalCommitment), by=list(fundraisingUnit)]
View(chart.GaCommitByUnit)
setnames(chart.GaCommitByUnit, c("V1", "fundAmount"))
View(chart.GaCommitByUnit)
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
View(chart.GaCommitByFund02)
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
View(chart.GaCommitByFund02)
chart.GaCommitByFund02%>%rename.columns(chart.GaCommitByFund02,list(V1='fundAmount'))
chart.GaCommitByFund02%>%rename.columns(chart.GaCommitByFund02,list(V1=fundAmount))
list(V1=fundAmount)
list(V1='fundAmount')
chart.GaCommitByFund02%>%rename.columns(chart.GaCommitByFund02,list(V1='fundAmount''))
rename.columns(chart.GaCommitByFund02,list(V1='fundAmount'))
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
View(chart.GaCommitByFund01)
View(chart.GaCommitByFund02)
chart.GaCommitByFund02<-rename.columns(chart.GaCommitByFund02,list(V1='fundAmount'))
source('S:/ScholarshipsProject/R/ScholarshipProject/ScholarshipProject.r', echo=TRUE)
View(chart.GaCommitByFund02)
View(chart.GaCommitByUnit)
write.csv(chart.GaCommitByUnit, "graph/chart.GaCommitByUnit.csv", row.names=F)
getwd()
write.csv(chart.GaCommitByUnit, "graph\chart.GaCommitByUnit.csv", row.names=F)
write.csv(chart.GaCommitByUnit, "graph/chart.GaCommitByUnit.csv", row.names=F)
write.csv(chart.GaCommitByUnit, "graphs/chart.GaCommitByUnit.csv", row.names=F)
View(chart.GaCommitByFund01)
View(chart.GaCommitByYear)
write.csv(chart.GaCommitByYear, "graphs/chart.GaCommitByYear.csv", row.names=F)
View(tbl.fundSummary)
tbl.fundSummary %>% mutate(cuts = cut(value, c(0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n(totBalRemain))
group_by(cuts) %>%
summarize(n=n(totBalRemain))
tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
tbl.fundSummary %>% mutate(range = cut(totBalRemain, c(0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
rangeAmt<-tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
View(project.info)
View(rangeAmt)
chart.rangefundAmt %>% tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
chart.rangefundAmt <- tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
View(chart.rangefundAmt)
write.csv(chart.rangefundAmt, "graphs/chart.rangefundAmt.csv", row.names=F)
chart.rangefundAmt=data.table(chart.rangefundAmt)
chart.rangefundAmt
xxx<-chart.rangefundAmt
fctr.cols<- sapply(xxx,as.factor)
xxx
chart.rangefundAmt <- tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c('0', '100000','200000', '300000', '400000', Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
chart.rangefundAmt
chart.rangefundAmt <- tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
chart.rangefundAmt <- tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
seq(0, 500, by=100 )
chart.rangefundAmt <- tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(seq(0, 500, by=100 ), Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
chart.rangefundAmt <- tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(c(seq(0, 500, by=100 )), Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
chart.rangefundAmt <- tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(0, 100, 200, 300, 400, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
View(chart.rangefundAmt)
chart.rangefundAmt <- tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
View(tbl.GaCommitmentFundList.OSFA)
View(tbl.GaCommit)
View(fundCode)
View(jctCode)
chart.rangefundAmt <- tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(-100000, 0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())  %>%
mutate(Range=c("<$0","0-$100,000","$100,000-$200,000","$200,000-$300,000","$300,000-$400,000", ">$400,000")
View(chart.rangefundAmt)
chart.rangefundAmt <- tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(-100000, 0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())  %>%
mutate(Range=c("Less than $0","0-$100,000","$100,000-$200,000","$200,000-$300,000","$300,000-$400,000", ">$400,000")
View(chart.rangefundAmt)
chart.rangefundAmt <- tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(-100000, 0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())  %>%
mutate(Range=c("Less than $0","0-$100,000","$100,000-$200,000","$200,000-$300,000","$300,000-$400,000", "Greater than $400,000")
View(chart.rangefundAmt)
View(chart.rangefundAmt)
chart.rangefundAmt <- tbl.fundSummary %>% mutate(cuts = cut(totBalRemain, c(-100000, 0, 100000, 200000, 300000, 400000, Inf))) %>%
group_by(cuts) %>%
summarize(n=n())
View(chart.rangefundAmt)
View(chart.rangefundAmt)
